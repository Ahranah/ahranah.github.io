---
layout: post
title: 금융전략을 위한 머신러닝 PCA
date: 2024-09-30 09:18:00-0400
description: 금융전략을 위한 머신러닝 Chap 5
tags: formatting jupyter
categories: sample-posts
giscus_comments: true
related_posts: false
---

## 7.1 차원 축소 기술
- PCA(Priciple component analysis) 주성분 분석
- KPCA(Kernel priniciple component analysis) 커널 주성분 분석
- t-SNE(t-distributed stochastic neighbor embedding) t-분산 확률적 이웃 임베딩

정보가 없는 데이터의 변동을 무시하거나 데이터가 있는 저차원 부분공간을 식별함으로써 데이터를 저차원 공간에 투영한다.


### PCA
선형 조합으로 원래 변수를 산출하는 새로운 변수셋을 찾는다. 이때 새로운 변수를 PC라고 한다. 이러한 주성분은 직교(독립적)이며 원본 데이터를 나타낼 수 있다. 
주성분을 찾는 방법에는 고유 분해(Eligen decomposition)과 특이값 분해(Singular value decomposition SVD)가 있다. 

#### 고유 분해
> 1. 특성에 대한 공분산 행렬을 생성한다.
> 2. 공분산 행렬을 계산한 다음 공분산 행렬의 고유 벡터를 계산한다. 이것이 최대 분산 방향이다.
> 3. 고윳값을 생성한다. 이는 주성분의 크기를 정의한다.

#### 특이값 분해
행렬을 세 개의 행렬로 분해하는 것으로 보다 일반적인 m x n 직사각형 행렬에 적용할 수 있다. 

SVD와 고유 분해는 항상 같은 값을 준다. 
SVD는 희소 행렬(0이 대부분인 행렬)을 처리할 수 있으므로 **고유 분해** 보다 훨씬 효율적일 수 있다. 
특히 일부 특성이 강한 상관관계를 가질 때 더 좋은 수치 안정성을 산출한다. 


### KPCA(커널 주성분 분석)
선형 변환만 가능했던 PCA를 확장하여 비선형성을 처리한다.
원본 데이터를 비선형 특성 공간(일반적으로 더 높은 차원의 공간)에 매핑한다. 그런 뒤 PCA를 적용해 해당 공간에서 주성분을 추출한다. 





To include a jupyter notebook in a post, you can use the following code:

{% raw %}

```liquid
{::nomarkdown}
{% assign jupyter_path = 'assets/jupyter/blog.ipynb' | relative_url %}
{% capture notebook_exists %}{% file_exists assets/jupyter/blog.ipynb %}{% endcapture %}
{% if notebook_exists == 'true' %}
  {% jupyter_notebook jupyter_path %}
{% else %}
  <p>Sorry, the notebook you are looking for does not exist.</p>
{% endif %}
{:/nomarkdown}
```

{% endraw %}

Let's break it down: this is possible thanks to [Jekyll Jupyter Notebook plugin](https://github.com/red-data-tools/jekyll-jupyter-notebook) that allows you to embed jupyter notebooks in your posts. It basically calls [`jupyter nbconvert --to html`](https://nbconvert.readthedocs.io/en/latest/usage.html#convert-html) to convert the notebook to an html page and then includes it in the post. Since [Kramdown](https://jekyllrb.com/docs/configuration/markdown/) is the default Markdown renderer for Jekyll, we need to surround the call to the plugin with the [::nomarkdown](https://kramdown.gettalong.org/syntax.html#extensions) tag so that it stops processing this part with Kramdown and outputs the content as-is.

The plugin takes as input the path to the notebook, but it assumes the file exists. If you want to check if the file exists before calling the plugin, you can use the `file_exists` filter. This avoids getting a 404 error from the plugin and ending up displaying the main page inside of it instead. If the file does not exist, you can output a message to the user. The code displayed above outputs the following:

{::nomarkdown}
{% assign jupyter_path = "assets/jupyter/blog.ipynb" | relative_url %}
{% capture notebook_exists %}{% file_exists assets/jupyter/blog.ipynb %}{% endcapture %}
{% if notebook_exists == "true" %}
{% jupyter_notebook jupyter_path %}
{% else %}

<p>Sorry, the notebook you are looking for does not exist.</p>
{% endif %}
{:/nomarkdown}

Note that the jupyter notebook supports both light and dark themes.
